<!DOCTYPE html>
<html lang="en">

<head>

    
    <script async src="https://www.googletagmanager.com/gtag/js?id=UA-66582-32"></script>
    <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-66582-32');
    </script>

    <meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

<meta property="og:title" content="Snowflake Ingestion (1) Get started with the Feature Store" />
<meta property="og:description" content="Get started with Snowflake and the Hopsworks Feature Store This tutorial notebook will help you to get started working with the Hopsworks feature store and Snowflake.
 We assume that you already have snowflake account. If not please follow the tutorial to setup your Snowflake account and load telcom churn dataset
  Create Snowflake connector in Hopsworks  Step1 ) From Hopsworks go to Feature Store select Storage Connectors and click Create New Step2 ) Fill in name and description of the connector." />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://examples.hopsworks.ai/featurestore/snowflake/get_started_setup/" />



<meta property="article:published_time" content="2021-02-24T00:00:00&#43;00:00"/>

<meta property="article:modified_time" content="2021-02-24T00:00:00&#43;00:00"/>











<meta name="twitter:card" content="summary"/>
<meta name="twitter:title" content="Snowflake Ingestion (1) Get started with the Feature Store"/>
<meta name="twitter:description" content="Get started with Snowflake and the Hopsworks Feature Store This tutorial notebook will help you to get started working with the Hopsworks feature store and Snowflake.
 We assume that you already have snowflake account. If not please follow the tutorial to setup your Snowflake account and load telcom churn dataset
  Create Snowflake connector in Hopsworks  Step1 ) From Hopsworks go to Feature Store select Storage Connectors and click Create New Step2 ) Fill in name and description of the connector."/>
<meta name="generator" content="Hugo 0.40.3" />

    
<script type="application/ld+json">
  {
  "@context": "http://schema.org",
  "@type": "BlogPosting",
  "headline": "Snowflake Ingestion (1) Get started with the Feature Store",
  "url": "https://examples.hopsworks.ai/featurestore/snowflake/get_started_setup/",
  "wordCount": "322",
  "datePublished": "2021-02-24T00:00:00&#43;00:00",
  "dateModified": "2021-02-24T00:00:00&#43;00:00",
  "author": {
  "@type": "Person",
  "name": ""
  }
  }
</script> 

    <title>Snowflake Ingestion (1) Get started with the Feature Store</title>

    
    <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/4.0.0-beta.2/css/bootstrap.min.css" integrity="sha384-PsH8R72JQ3SOdhVi3uxftmaW6Vc51MKb0q5P2rRUpPvrszuE4W1povHYgTpBfshb"
        crossorigin="anonymous">

    
    <link href="https://examples.hopsworks.ai/css/custom.css" rel="stylesheet">
    <link href="https://examples.hopsworks.ai/css/syntax.css" rel="stylesheet">
    <link href="https://fonts.googleapis.com/css?family=Muli:400,500,700" rel="stylesheet">

    <link href="" rel="alternate" type="application/rss+xml" title="Hopsworks Examples" />

    <script type="text/javascript" async
  src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.2/MathJax.js?config=TeX-MML-AM_CHTML">
</script>
<script type="text/x-mathjax-config">
MathJax.Hub.Config({
  tex2jax: {
    inlineMath: [['$','$'], ['\\(','\\)']],
    displayMath: [['$$','$$'], ['\[','\]']],
    processEscapes: true,
    processEnvironments: true,
    skipTags: ['script', 'noscript', 'style', 'textarea', 'pre','code'],
    TeX: { equationNumbers: { autoNumber: "AMS" },
         extensions: ["AMSmath.js", "AMSsymbols.js"] }
  }
});
</script>

</head>

<body>

    <nav class="navbar navbar-expand-sm fixed-top">
        <div class="container-fluid">
            <a class="navbar-brand" href="https://examples.hopsworks.ai">Hopsworks Examples</a>
            <button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#navbarSupportedContent" aria-controls="navbarSupportedContent"
                aria-expanded="false" aria-label="Toggle navigation">
                <span class="navbar-toggler-icon"></span>
            </button>

            <div class="collapse navbar-collapse" id="navbarSupportedContent">
                <ul class="nav navbar-nav mr-auto"></ul>
                <ul class="nav navbar-nav">
                    <li><a href="https://hopsworks.ai" title="Hopsworks.ai">Hopsworks</a></li>
                    <li><a href="https://docs.hopsworks.ai" title="Docs">Docs</a></li>
                </ul>
            </div>
        </div>
    </nav>


    
    <div class="container">
        <div class="row">
            <div class="col-sm-12">

                 


<article>
  <div class="technical_note">
    <header>
      <div class="alert alert-warning flashcard_ad" role="alert">
	Want to learn machine learning? Try my <a href="https://machinelearningflashcards.com" class="alert-link">machine learning flashcards</a>, <a href='https://amzn.to/2HwnWty' class="alert-link">book</a>, or <a href='https://www.youtube.com/channel/UCnd4Fi-ODvuPbxR2fO2j7kA' class="alert-link">study with me.</a>.
      </div>
      <h1 class="technical_note_title">Snowflake Ingestion (1) Get started with the Feature Store</h1>
      <div class="technical_note_date">
	<time datetime=" 2021-02-24T00:00:00Z "> 24 Feb 2021</time>
      </div>
    </header>
    <div class="content">

      

<h1 id="get-started-with-snowflake-and-the-hopsworks-feature-store">Get started with Snowflake and the Hopsworks Feature Store</h1>

<p>This tutorial notebook will help you to get started working with the Hopsworks feature store and Snowflake.</p>

<ul>
<li>We assume that you already have snowflake account. If not please follow the <a href="https://www.snowflake.com/webinar/virtual-hands-on-labs/virtual-hands-on-lab-2020-03-18/">tutorial</a> to setup your Snowflake account and load telcom churn dataset<br /></li>
</ul>

<h2 id="create-snowflake-connector-in-hopsworks-a-name-access-snowflake-a">Create Snowflake connector in Hopsworks <a name="access_snowflake"></a></h2>

<h4 id="step1-from-hopsworks-go-to-feature-store-select-storage-connectors-and-click-create-new">Step1 ) From Hopsworks go to Feature Store select Storage Connectors and click Create New</h4>

<p><img src="../../images/hopsworks/connector/1.png" alt="1.jpg" /></p>

<h4 id="step2-fill-in-name-and-description-of-the-connector-br">Step2 ) Fill in name and description of the connector. <br></h4>

<p>&nbsp; In JDBC connection string provide the connection and credentials required to connect to your Snowflake account.</p>

<p><strong>NOTE:</strong> For Snowflake accounts in regions other than US WEST add the Region ID after a period <ACCOUNT>.<REGION ID> i.e. ra96958.eu-central-1.</p>

<p>&nbsp; then click Create
<img src="../../images/hopsworks/connector/2.png" alt="2.jpg" /></p>

<h2 id="python">Python</h2>
<div class="highlight"><pre class="chroma"><code class="language-pyspark" data-lang="pyspark">import hsfs

connection = hsfs.connection()

# get a reference to the feature store, you can access also shared feature stores by providing the feature store name
fs = connection.get_feature_store()
connector = fs.get_storage_connector(&#34;snowflake_spark_connector&#34;, &#34;JDBC&#34;)</code></pre></div><div class="highlight"><pre class="chroma"><code class="language-pyspark" data-lang="pyspark">import snowflake.connector # tested on snowflake-connector-python==2.3.1 
# Connecting to Snowflake using the default authenticator
ctx = snowflake.connector.connect(
  user=&#39;HOPSWORKS&#39;,
  password=connector.arguments,
  account=&#39;ra96958.eu-central-1&#39;,
  warehouse=&#39;HOPSWORKS_WH&#39;,
  database=&#39;ML_WORKSHOP&#39;,
  schema=&#39;PUBLIC&#39;
)</code></pre></div><div class="highlight"><pre class="chroma"><code class="language-pyspark" data-lang="pyspark">import pandas as pd
# Query Snowflake Data
cs=ctx.cursor()
allrows=cs.execute(&#34;&#34;&#34;select Cust_ID,STATE,ACCOUNT_LENGTH,AREA_CODE,PHONE,INTL_PLAN,VMAIL_PLAN,VMAIL_MESSAGE,
                   DAY_MINS,DAY_CALLS,DAY_CHARGE,EVE_MINS,EVE_CALLS,EVE_CHARGE,NIGHT_MINS,NIGHT_CALLS,
                   NIGHT_CHARGE,INTL_MINS,INTL_CALLS,INTL_CHARGE,CUSTSERV_CALLS,
                   CHURN from CUSTOMER_CHURN &#34;&#34;&#34;).fetchall()

churn = pd.DataFrame(allrows)
churn.columns=[&#39;Cust_id&#39;,&#39;State&#39;,&#39;Account Length&#39;,&#39;Area Code&#39;,&#39;Phone&#39;,&#39;Intl Plan&#39;, &#39;VMail Plan&#39;, &#39;VMail Message&#39;,&#39;Day Mins&#39;,
            &#39;Day Calls&#39;, &#39;Day Charge&#39;, &#39;Eve Mins&#39;, &#39;Eve Calls&#39;, &#39;Eve Charge&#39;, &#39;Night Mins&#39;, &#39;Night Calls&#39;,&#39;Night Charge&#39;,
            &#39;Intl Mins&#39;,&#39;Intl Calls&#39;,&#39;Intl Charge&#39;,&#39;CustServ Calls&#39;, &#39;Churn?&#39;]

pd.set_option(&#39;display.max_columns&#39;, 500)     # Make sure we can see all of the columns
pd.set_option(&#39;display.max_rows&#39;, 10)         # Keep the output on one page
churn</code></pre></div>
<h2 id="spark">Spark</h2>

<h4 id="step-1-attache-snowflake-jdbc-3-12-8-jar-to-the-cluster">Step 1: Attache snowflake-jdbc-3.12.8.jar to the cluster.</h4>

<h4 id="https-mvnrepository-com-artifact-net-snowflake-snowflake-jdbc-3-12-8"><a href="https://mvnrepository.com/artifact/net.snowflake/snowflake-jdbc/3.12.8">https://mvnrepository.com/artifact/net.snowflake/snowflake-jdbc/3.12.8</a></h4>

<h4 id="step-2-attache-spark-snowflake-2-11-2-8-1-driver-to-the-cluster">Step 2: Attache spark-snowflake_2.11-2.8.1 driver to the cluster.</h4>

<h4 id="https-mvnrepository-com-artifact-net-snowflake-spark-snowflake-2-11-2-8-1-spark-2-4"><a href="https://mvnrepository.com/artifact/net.snowflake/spark-snowflake_2.11/2.8.1-spark_2.4">https://mvnrepository.com/artifact/net.snowflake/spark-snowflake_2.11/2.8.1-spark_2.4</a></h4>
<div class="highlight"><pre class="chroma"><code class="language-pyspark" data-lang="pyspark">import com.logicalclocks.hsfs._
import scala.collection.JavaConversions._
import collection.JavaConverters._

val connection = HopsworksConnection.builder().build();
val fs = connection.getFeatureStore();
val connector = fs.getStorageConnector(&#34;snowflake_spark_connector&#34;,StorageConnectorType.JDBC)</code></pre></div><div class="highlight"><pre class="chroma"><code class="language-pyspark" data-lang="pyspark">val SNOWFLAKE_SOURCE_NAME = &#34;net.snowflake.spark.snowflake&#34;
val sfOptions = Map(
&#34;sfURL&#34; -&gt; connector.getConnectionString(),
&#34;sfUser&#34; -&gt; &#34;HOPSWORKS&#34;,
&#34;sfPassword&#34; -&gt; connector.getArguments(),
&#34;sfDatabase&#34; -&gt; &#34;ML_WORKSHOP&#34;,
&#34;sfSchema&#34; -&gt; &#34;PUBLIC&#34;,
&#34;sfWarehouse&#34; -&gt; &#34;HOPSWORKS_WH&#34;,
&#34;sfRole&#34; -&gt; &#34;HOPSWORKS_ROLE&#34;
)

val df = spark.read.
format(SNOWFLAKE_SOURCE_NAME).
options(sfOptions).
option(&#34;dbtable&#34;, &#34;CUSTOMER_CHURN&#34;).
load()</code></pre></div><div class="highlight"><pre class="chroma"><code class="language-pyspark" data-lang="pyspark"></code></pre></div>
    </div>
    <aside>
      <div class="bug_reporting">
	<h4>Find an error or bug?</h4>
	<p>Everything on this site is available on GitHub. Head to <a href='https://github.com/chrisalbon/notes/issues/new'>and submit a suggested change</a>. Include the tutorial's URL in the issue.</p>
      </div>
    </aside>

  </div>
</article>




            </div>

        </div>
    </div>

    

    <footer class="footer text-center">
        <div class="container">
            <span class="text-muted">There are 59 notebooks and they are available on <a href="https://github.com/logicalclocks/hops-examples">GitHub</a>. Copyright &copy; Logical Clocks AB, <time datetime="2021">2021</time>.</span>
        </div>
    </footer>

    <script src="https://code.jquery.com/jquery-3.2.1.slim.min.js" integrity="sha384-KJ3o2DKtIkvYIK3UENzmM7KCkRr/rE9/Qpg6aAZGJwFDMVNA/GpGFF93hXpG5KkN"
        crossorigin="anonymous"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.12.3/umd/popper.min.js" integrity="sha384-vFJXuSJphROIrBnz7yo7oB41mKfc8JzQZiCq4NCceLEaO4IHwicKwpJf9c9IpFgh"
        crossorigin="anonymous"></script>
    <script src="https://maxcdn.bootstrapcdn.com/bootstrap/4.0.0-beta.2/js/bootstrap.min.js" integrity="sha384-alpBpkh1PFOepccYVYDB4do5UnbKysX5WZXm3XxPqe5iKTfUKjNkCk9SaVuEZflJ"
        crossorigin="anonymous"></script>

</body>

</html>
